---
title: "From Mild to Wild"
subtitle: "INFO 526 - Fall 2023 - Project 1"
author: "ScatterPlot-Sorcerers"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
    transition: convex
    background-transition: concave
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidymodels,
               tidyverse)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here
data(mtcars)
mtcars$speed <- mtcars$hp / mtcars$wt

data("penguins")
```

##  {auto-animate="true"}

### So what is the Hot ones ? {transition="concave-in slide-out"}

![](images/Untitled-removebg-preview.png){fig-align="center"}

##  {auto-animate="true"}

### So what is the Hot ones ? {transition="concave-in slide-out"}

![](images/intro-1556638929.jpg)

```{=html}
<pre style="font-size:100%"><b>Eat and feel the heat</b></pre>
```
## Scoville Scale {transition="convax-in slide-out"}

*Well we all know guns right ?*

![](images/Sauces(img_transparent).png){fig-alt="sauces and program explained" fig-align="center" width="100%"}

## Why this Data set ABOUT?

::: columns
::: {.column width="40%"}
"Hot Ones" YouTube series overview

More than just a hot wing challenge

**Popularity Factors**

-   Concept of "schadenfreude"

-   Candid celebrity conversations

-   Unexpected reactions
:::

::: {.column width="60%"}
![Billie Eilish, Shaq, and Tom Holland burning up and bugged-eyed on Hot Ones. Credit: First We Feast](images/Picture1.png){fig-alt="Billie Eilish, Shaq, and Tom Holland burning up and bugged-eyed on Hot Ones. Credit: First We Feast" width="422"}

![Melissa McCarthy uses a spray bottle full of milk. Credit: First We Feast](images/MelissaMcCarthy.jpg){fig-alt="Melissa McCarthy uses a spray bottle full of milk. Credit: First We Feast" width="427"}
:::
:::

# Why this Data set?

::: columns
::: {.column width="50%"}
**Cultural Impact**

-   Memes, gifs, and sayings

-   Resonance with global audiences

**Dataset Selection**

-   TidyTuesday repository

-   "Hot Ones Episodes" dataset spotlight

-   Team's diverse familiarity with the show
:::

::: {.column width="50%"}
!["Hey, look at us." meme/gif of Paul Rudd. Credit First We Feast](images/PaulRudd.jpeg){fig-alt="\"Hey, look at us.\" meme/gif of Paul Rudd. Credit First We Feast" width="379"}

![Aubrey Plaza snorts milk. Credit: First We Feast](images/AubreyPlazaSnortsMilk.png){fig-alt="Aubrey Plaza snorts milk. Credit: First We Feast" width="393"}
:::
:::

## Code

```{r, echo=FALSE}
model <- lm(mpg ~ speed, data = mtcars) 

model |> tidy()

model |> glance()

```

## Plots

```{r}
# Importing the required libraries
library(readr)
library(dplyr)
library(scales)
library(ggplot2)

# Reading the data
episodes <- read.csv('data/episodes.csv')
sauces <- read.csv('data/sauces.csv')
seasons <- read.csv('data/seasons.csv')


#Creating the data frame with mean scoville score of each season
scoville_scores <- sauces %>%
  group_by(season) %>%
  summarize(avg_scoville = mean(scoville, na.rm = TRUE))

# Filtering the columns with unfinished contestants
unfinished_df <- episodes[episodes$finished == FALSE, ]

max_avg_scoville <- max(scoville_scores$avg_scoville)
scale_factor <- 3 / max_avg_scoville

# Function to 
map_y2 <- function(y) y * scale_factor

# Pre-format the labels for the right y-axis using scales::number_format
formatted_labels <- number_format(scale = 0.001, accuracy = 1, suffix = "K")(c(0.00, 0.75, 1.50, 2.25, 3.00) / scale_factor)

plt <- ggplot() +
  geom_histogram(data = unfinished_df, aes(x = season), fill = "orange", binwidth = 1) +
  theme_minimal() +
  theme(axis.text.y = element_text(color = "orange"), axis.title.y = element_text(color = "orange"))

# Modify the scale_y_continuous function to set the limits for both axes
plt + geom_point(data = scoville_scores, aes(season, map_y2(avg_scoville))) +
  geom_smooth(data = scoville_scores, aes(season, map_y2(avg_scoville)), se = FALSE, color = "red") +
  labs(x = "Season",
       y = "Number of Unfinished contestants",
       title = "Average Scoville Score vs Number of Unfinished Contestants",
       subtitle = "by Season",
       caption = "Source: Tidytuesday") +
  theme(axis.text.y.right = element_text(color = "red"), axis.title.y.right = element_text(color = "red")) +
  scale_y_continuous(
    limits = c(0, 3),  # Set limits for the left y-axis
    sec.axis = sec_axis(
      trans = ~ . / scale_factor,
      name = "Average Scoville Score",
      breaks = seq(0, max_avg_scoville, by = max_avg_scoville / 4),
      labels = formatted_labels
    ) # Set breaks and labels for the right y-axis
  )
```

## Plot and text

::: columns
::: {.column width="50%"}
-   Some text

-   goes here
:::

::: {.column width="50%"}
```{r, warning=FALSE, fig.width=5.5}
penguins |>
  ggplot(aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot(linewidth = 0.75,
               outlier.size = 2.5) +
  theme_minimal(base_size = 15) +
  theme(legend.key.size = unit(0.8, "cm"))
```
:::
:::

# A new section...

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r}
penguins |> 
  head() |>
  kableExtra::kable() |>
  kableExtra::kable_styling()
```

## Images

![Image credit: Danielle Navarro, Percolate.](images/watercolour_sys02_img34_teacup-ocean.png){fig-align="center" width="500"}

## Math Expressions {.smaller}

You can write LaTeX math expressions inside a pair of dollar signs, e.g.Â \$\\alpha+\\beta\$ renders $\alpha + \beta$. You can use the display style with double dollar signs:

```         
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$
\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
$$

Limitations:

1.  The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

2.  There should not be spaces after the opening `$` or before the closing `$`.

# Wrap up

## Feeling adventurous?

-   You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

-   But some of you might want to play around with slide styling. Some solutions for this can be found at https://quarto.org/docs/presentations/revealjs.
